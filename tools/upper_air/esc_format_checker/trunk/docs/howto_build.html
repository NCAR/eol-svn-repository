<html>
<head>
    <title>How To: Build/Develop the Format Checkers</title>
    <link rel="stylesheet" type="text/css" href="/css/howto.css" />
</head>
<body>
<h1 class="title">How To: Build/Develop the Format Checkers</h1>

<a name="top"></a>
<h2>Contents</h2>
<ol>
    <li><a href="#about">About</a></li>
    <li><a href="#build">Build</a></li>
    <li><a href="#develop">Development</a></li>
    <li><a href="#checks">Checks</a></li>
</ol>
<hr />

<a name="about"></a>
<h2>About</h2>
<p>This document contains information that may be useful to anyone going to work on the format checking software.  This includes upgrading existing checkers or adding new ones.</p>
<p>The software described in this document is written in Java 1.5 with the use of generics. Java 1.5 or newer is required for the software to run.</p>

<p><a href="#top">Top</a></p>
<hr />


<a name="build"></a>
<h2>Build</h2>
<p>The build is defined in the <i>build.xml</i> file and uses Ant.  If you have not configured Ant in your environment, you will need to follow the instructions <a href="http://www.eol.ucar.edu/about/our-organization/cds/dmg/dmg-internal/dmg-documentation/how-to/ant-setup-and-use/#environment">here</a> or you won't be able to build the checkers with Ant.</p>

<h3>Directory Layout</h3>
<table class="directories">
   <tr>
      <th>build</th>
      <td>This directory may not exist initially and is removed when the <span class="softwareName">clean</span> comman is run.  It contains the .class files generated from compiling the .java source.</td>
   </tr>
   <tr>
      <th>dist</th>
      <td>This directory is generated by the build when the jar file is being prepared for production.  This is used so the user can check the contents of the layout before deploying it into production.  This directory is removed when the <span class="softwareName">clean</span> command is run.</td>
   </tr>
   <tr>
      <th>docs</th>
      <td>This directory contains all fo the documentation for the format checkers.  It also contains an API directory which is automatically created for the javadocs and is removed when the <span class="softwareName">clean</span> command is run.</td>
   </tr>
   <tr>
      <th>src</th>
      <td>This directory contains all of the .java source files for the format checker.</td>
   </tr>
   <tr>
      <th>tests</th>
      <td>This directory the JUnit .java source files used for testing the format checker.  This does not contain any production software.</td>
   </tr>
</table>

<h3>build.xml Targets</h3>
<table class="directories">
   <tr>
      <th>clean</th>
      <td>Remove all generated content from the working area.  This removes the build, dist, and docs/api directories.</td>
   </tr>
   <tr>
      <th>compile</th>
      <td>Compile the format checking source code for execution.  The .class files are placed into the build directory.</td>
   </tr>
   <tr>
      <th>compileTests</th>
      <td>Compile the format checking test source code.  This requires the source files to be compiled and will perform the operation if necessary.</td>
   </tr>
   <tr>
      <th>deploy</th>
      <td>Copy the jar file to the production area and replace all of the public javadocs with a fresh copy.  This will perform all necessary operations to create the jar file and generate the javadocs that have not been performed already.</td>
   </tr>
   <tr>
      <th>dist</th>
      <td>Generate the jar file to be used in production.  This will compile the .java files if they have not already been created.  The jar file does not contain any test software.</td>
   </tr>
   <tr>
      <th>javadoc</th>
      <td>Create the javadoc files for the non-test source files.  This also copies the howtos as part of the API.  The files are added to the docs/api directory so the directory can be copied to the public area on deployment.</td>
   </tr>
   <tr>
      <th>test</th>
      <td>Execute the JUnit tests for teh format checker.  All failures need to be addressed before the jar file is deployed.</td>
   </tr>
</table>

<p><a href="#top">Top</a></p>
<hr />


<a name="develop"></a>
<h2>Development</h2>
<p>The format checker is defined in the ESCCheckFile class.  It is a controller for the checker and uses the State Pattern defined in the Design Patterns book by Gamma et. al.  Each ESC line format has its own concrete state that defines the checks to be peformed on that line.  This design allows the each line to be checked correctly even if it is on an unexpected line.  This allows the checker to provide the most problems on a single check to the user by assuming as little as possible.  (It still must assume that the entire header label matches the expected label or it thinks it will be a data line.)  This limits the checker to only be able to check a single sounding per file since any header line past the first 15 lines of the data file will cause an warning in the log file since they won't be on the expected line.</p>

<p><a href="#top">Top</a></p>
<hr />


<a name="checks"></a>
<h2>Checks</h2>
<p>The following is the list of checks performed by the ESC format checker.</p>
<ul>
    <li>Expected Header Labels</li>
    <li>Header Labels End In Colon</li>
    <li>Header labels are properly padded.</li>
    <li>Header contains values after the label</li>
    <li>Header dates properly formatted in YYYY, MM, DD, HH:MM:SS</li>
    <li>Optional Header Lines either are label / value sets or just a /</li>
    <li>Release location is on the earth (valid lats/lons)</li>
    <li>Data Header Labels are correct with proper spacing and length</li>
    <li>Data lines have correct length with proper spacing</li>
    <li>Numerical values are actually numbers</li>
    <li>Value/Flag values match.</li>
    <li>All wind values for a record are either missing or not-missing</li>
    <li>U and V wind flags are the same.</li>
    <li>Dew Point only exists when both temperature and relative humdiity aren't missing.</li>
    <li>Release location in header matches first data line location.</li>
    <li>Nominal release is within 3 hours of actual release.</li>
    <li>Data times are constantly increasing/decreasing (doesn't care which)</li>
</ul>

<p><a href="#top">Top</a></p>
<hr />

<p class="foot">Last Updated: August 21, 2007 - jclawson</p>
</body>
</html>
