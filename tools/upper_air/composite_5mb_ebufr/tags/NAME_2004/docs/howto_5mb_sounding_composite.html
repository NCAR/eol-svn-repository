<html>
<head>
   <title>How To: 5 mb Level Sounding Composite (EBUFR)</title>
   <style>
   <!--
   a:link,a:visited { color: blue; text-decoration: none; }
   a:hover { color: red; text-decoration: underline; }
   body {
      font-family: Arial, sans-serif;
      font-size: 12pt;
   }
   h1 { text-align: center; }
   p.code {
      font-family: monospace;
      font-weight: bold;
      text-align: left;
      text-indent: 50px;
   }
   p.foot {
      font-style: italic;
      text-align: right;
   }
   th.dir {
      text-align: left;
   }
   -->
   </style>
</head>

<body>
<h1>How To: 5 mb Level Sounding Composite (EBUFR)</h1>

<h2>Table of Contents</h2>
<ul>
   <li><a href="#purpose">Purpose</a></li>
   <li><a href="#repos">Repository</a></li>
   <li>Previous Versions<ul>
      <li><a href="#ver_NAME">NAME_2004</a></li>
      </ul></li>
   <li><a href="#directory">Directory Structure</a></li>
   <li>Processing the Data<ul>
      <li><a href="#copy">Copy the Data</a></li>
      <li><a href="#extract">Extract 5mb Levels</a></li>
      <li><a href="#day">Create EBUFR Day Files</a></li>
      <li><a href="#insert">Insert the EBUFR File into the Database</a></li>
      </ul></li>
   <li><a href="#software">Software</a></li>
   <li><a href="#docs">Documentation</a></li>
</ul>
<hr>

<a name="purpose"></a>
<h2>Purpose</h2>
<p>The purpose of this document is to describe the process for creating the 5mb Level Upper Air Composite.  It will tell where the software and documentation can be found, how to run the software, and put the dataset into the database.</p>
<hr>

<a name="repos"></a>
<h2>Repository</h2>
<p>The software and documentation for this composite is in subversion.  (For more on subversion see: <a href="/dpg/GENERAL/repository/howto_subversion.html">How To: Subversion</a>.)  The repository location can be found at:</p>
<p class="code">/work/software/repository/subversion/tools/upper_air/composite/5mb/ebufr</p>
<p>and</p>
<p class="code">/work/software/repository/subversion/tools/upper_air/composite/5mb/extracter</p>
<hr>

<h2>Previous Version</h2>

<a name="ver_NAME"></a>
<h3>NAME_2004</h3>
<table border=1>
  <tr>
    <th class="dir">Raw Data:</th>
    <td>In individual directories for the networks to be included in the composite.</td>
  </tr>
  <tr>
    <th class="dir">Final Data:</th>
    <td>/work/NAME/upper_air/composite_5mb/ebufr</td>
  </tr>
  <tr>
    <th class="dir">Software:</th>
    <td>
       /work/NAME/upper_air/composite_5mb/software<br>
       /work/NAME/upper_air/composite_5mb/extracter
    </td>
  </tr>
</table>
<hr>

<a name="directory"></a>
<h2>Directory Structure</h2>
<table border=1>
  <tr>
    <th class="dir">5mb</th>
    <td>The directory where the extracted 5 mb files are to be stored.</td>
  </tr>
  <tr>
    <th class="dir">data</th>
    <td>The directory where the <i>raw</i> unprocessed CLASS files are to be stored.</td>
  </tr>
  <tr>
    <th class="dir">docs</th>
    <td>The directory where the documentation files for the 5mb extraction are to be stored.</td>
  </tr>
  <tr>
    <th class="dir">ebufr</th>
    <td>The directory where the final EBUFR day files are to be stored.</td>
  </tr>
  <tr>
    <th class="dir">extracter</th>
    <td>The directory where the 5mb extraction software is stored.</td>
  </tr>
  <tr>
    <th class="dir">logs</th>
    <td>The directory where the logs generated by the 5mb extraction software are to be stored.</td>
  </tr>
  <tr>
    <th class="dir">software</th>
    <td>The directory where the non-extraction software is to be stored.</td>
  </tr>
</table>
<hr>


<h2>Processing the Data</h2>
<a name="copy"></a>
<h3>Copy the Data</h3>
<p>Before the EBUFR files can be created, the CLASS files that are going to be included in the composite needed to be copied into the data directory. This is done by using the <b>copy_class_files.pl</b> script. This script needs to be edited to change the project's time of interest along with the names and locations of the CLASS files for each network. The script fully prepares the data (aligning it into directories by network, making sure only the files in the time of interest are included, and gunzipping the data).</p>
<p>The files must all be uncompressed for the extraction software to work correctly.</p>

<a name="extract"></a>
<h3>Extract 5mb Levels</h3>
<p>Once the data has been copied, the extraction software must be used to extract the 5 mb levels from the highest resolution files.  This software is in FORTRAN and needs to be pulled from a separate repostitory than the general software and the binary needs to be generated.  See <a href="../extracter/docs/howto_5mb_extracter_software.html">How To: 5 mb Extracter Software</a> on how to do this.</p>
<p>After the <code>extract5mb</code> binary is created and in the appropriate directory, the <b>create_5mb_files.pl</b> script needs to be called.  This will extract the 5 mb levels from each of the CLASS files in the <b>data</b> directory and place them in the <b>5mb</b> directory.  All of the log files generated by the extracter are placed in the <b>logs</b> directory.</p>

<a name="day"></a>
<h3>Create EBUFR Day Files</h3>
<p>Now that the 5 mb files have been generated, they need to be converted into EBUFR day files.  This uses the create_5mb_ebufr_files.pl script and depends on the class2ebufr binary.  More information on the EBUFR process can be found at: <a href="somewhere.html">How To: EBUFR CLASS Sounding Data</a>.
<ol>
   <li>Make sure that there are 5 configuration files in the software directory (class_file, code_08_021, code_33_254, control_scf.txt, desc_file).  The class2bufr program requires all of these files to exist in the current directory and will crash without them.  (create_5mb_ebufr_files.pl knows where these files need to belong and when.)</li>
   <li>Edit the <b>control_scf.txt</b> file.  This contains the name of the soundings that will be printed for the data header.  It needs to be changed to match the current project (line 12).  (None of the other configuration files should be editted.)</li>
   <li>Edit the <b>create_5mb_ebufr_files.pl</b> script.  The project and class2ebufr need to be changed to match the current project.  Also, the file name needs to be checked to make sure that the correct files will be created (should not have to be changed).</li>
   <li>Run the <b>create_5mb_ebufr_files.pl</b> script.  This will create the EBUFR day files by concatenating the .05mb files in their natural sort order for a day and then convert the day file to EBUFR.</li>
</ol>

<a name="insert"></a>
<h3>Insert the EBUFR Files into the Database</h3>
<p>With all of the EBUFR files created, they need to be inserted into the database. This is a general process and is explained in the document: <a href="/dpg/GENERAL/soundings/howto_insert_ebufred_class_soundings.html">How To: Insert EBUFRed Sounding Data</a>.</p>
<hr>

<a name="software"></a>
<h2>Software</h2>
<ul>
   <li><a href="../software/class_file">class_file</a>- Required EBUFR file</li>
   <li><a href="../software/code_08_021">code_08_021</a>- Required EBUFR file</li>
   <li><a href="../software/code_33_254">code_33_254</a>- Required EBUFR file</li>
   <li><a href="../software/control_scf.txt">control_scf.txt</a>- Required EBUFR file</li>
   <li><a href="/cgi-bin/dpg/doc/docperl.cgi?file=/work/NAME/upper_air/composite_5mb/software/copy_class_files.pl">copy_class_files.pl</a>- copies the data to have 5 mb extractions</li>
   <li><a href="/cgi-bin/dpg/doc/docperl.cgi?file=/work/NAME/upper_air/composite_5mb/software/create_5mb_ebufr_files.pl">create_5mb_ebufr_files.pl</a>- creates the EBUFR day files from the 5 mb data files</li>
   <li><a href="/cgi-bin/dpg/doc/docperl.cgi?file=/work/NAME/upper_air/composite_5mb/software/create_5mb_files.pl">create_5mb_files.pl</a>- creates the 5 mb data files</li>
   <li><a href="../software/desc_file">desc_file</a>- Required EBUFR file</li>
</ul>
<hr>

<a name="docs"></a>
<h2>Documentation</h2>
<ul>
   <li><a href="howto_5mb_sounding_composite.html">How To: 5 mb Sounding Composite</a>- this document</li>
   <li><a href="../extracter/docs/howto_5mb_extracter_software.html">How To: 5 mb Extraction Software</a>- how to document on creating and using the 5 mb extraction software</li>
   <li><a href="">How To: EBUFR CLASS Sounding Data</a>- how to document on converting CLASS files to EBUFR</li>
   <li><a href="/dpg/GENERAL/soundings/howto_insert_ebufred_class_soundings.html">How To: Insert EBUFRed Sounding Data</a>- how to document on insert sounding data into the database</li>
   <li><a href="/dpg/GENERAL/repository/howto_subversion.html">How To: Subversion</a>- how to document on using subversion</li>
   <li><a href="/dpg/GENERAL/soundings">Sounding Index</a>- index to the DPG sounding information</li>
</ul>
<hr>

<p class="foot">Last Update: February 7, 2006 - Joel Clawson</p>

</body>
</html>
