<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>How To: Build/Develop Upper Air Day File Creator</title>
    <link rel="stylesheet" type="text/css" href="http://dmg.eol.ucar.edu/css/howto.css" />
  </head>

  <body>
    <h1>How To: Build/Develop Upper Air Day File Creator</h1>

    <a name="top"></a>
    <h2>Contents</h2>
       <ol>
          <li><a href="#about">About</a></li>
          <li><a href="#build">Build</a></li>
          <li><a href="#develop">Development</a></li>
       </ol>
    <hr />

    <a name="about"></a>
    <h2>About</h2>
    <p>This document contains the information that is useful for anyone that is going to work on the develoment of upper air day files creators.  This includes upgrading existing pieces or adding creators for new formats.</p>
    <p>The software described in this document is written in Java 1.5 with the use of generics.  Java 1.5 or newer is required for the software to run.</p>
    <p>The upper air day file software is designed to allow it to be extended to handle multiple formats of upper air data.</p>

    <p><a href="#top">Top</a></p>
    <hr />


    <a name="build"></a>
    <h2>Build</h2>
    <p>The build is defined in the <i>build.xml</i> file and uses Ant.  If you have not configured Ant in your environment, you will need to follow the instructions <a href="http://www.eol.ucar.edu/about/our-organization/cds/dmg/dmg-internal/dmg-documentation/how-to/ant-setup-and-use">here</a> or you won't be able to build the day file creators.</p>

    <h3>Directory Layout</h3>
    <table class="directories">
        <tr>
            <th>build</th>
            <td>This directory may not exist initially and is removed when the <span class="softwareName">clean</span> command is run.  It contains the .class files generated after compiling the .java source files.</td>
        </tr>
        <tr>
            <th>dist</th>
            <td>This directory is generated by the build when the jar file is being prepared for production.  This is used so the user can check the contents and layout before deploying into actual production.  This directory is removed when the <span class="softwareName">clean</span> command is run.</td>
        </tr>
        <tr>
            <th>docs</th>
            <td>This directory contains all of the documentation for the day file creators.  It also contains an API directory which is automatically generated during the creation of the javadoc and is removed when the <span class="softwareName">clean</span> command is run.</td>
        </tr>
        <tr>
            <th>src</th>
            <td>This directory contains all of the .java source files for the day file creators.</td>
        </tr>
        <tr>
            <th>tests</th>
            <td>This directory contains all of the JUnit .java source files used for testing the day file creators.  This does not contain any production software.</td>
        </tr>
    </table>

    <h3>build.xml Targets</h3>
    <table class="directories">
        <tr>
            <th>clean</th>
            <td>Remove all automatically generated content from the working area.  This removes the build, dist, and docs/api directories.</td>
        </tr>
        <tr>
            <th>compile</th>
            <td>Compile all source code and prepare it for execution.</td>
        </tr>
        <tr>
            <th>compileTests</th>
            <td>Compile the JUnit tests into .class files.  This requires the source files to be compiled as well and will perform the operation if necessary.</td>
        </tr>
        <tr>
            <th>deploy</th>
            <td>Copy the jar file to the production area and replace all of the public javadoc with a newly generated copy.  This will perform all necessary operations to create the jar file and javadocs if they have not already been created.</td>
        </tr>
        <tr>
            <th>dist</th>
            <td>Generate the jar file to be used in production.  This will compile the java files if they have not already been created.  The jar file does not contain any test software.</td>
        </tr>
        <tr>
            <th>javadoc</th>
            <td>Generate hte javadoc files for the non-test files.  This also copies all how tos listed in the overview with the API.  All of the files are added to the docs/api directory so the entire directory can be copied to the public area when deployed.</td>
        </tr>
        <tr>
            <th>test</th>
            <td>Execute the JUnit tests for the day file creator.  Any failures need to be corrected before the jar file is deployed.</td>
        </tr>
    </table>

    <p><a href="#top">Top</a></p>
    <hr />

    <a name="develop"></a>
    <h2>Development</h2>
    <p>The DayFileCreator class was designed as an abstract class to allow it to be extended to handle multiple sounding file formats.  It handles the process of reading the input sounding files, parsing them into Sounding objects from the parse defined by the extending class, using the Sounding objects to sort by nominal release date/time followed by latitude and longitude, and finally generating day files from the sorted input soundings.</p>
    <p>The DayFileCreator is I/O intensive.  Since most soundings have a very high resolution in their data, the creator can not store the entire sounding for all of the soundings in memory. (It ran into a heap overflow near 500 soundings during development tests).  The creator stores only the header information for the sounding in memory to use in its sorting process and drops all of the data.  This causes each sounding to be read twice by the creator.  Once to pull out the header information and again to read in the entire sounding to be written to the day file.  This does make the script a bit slower, but speed is typically not an issue when generating day files.</p>
    <p>The extensions of the DayFileCreator only need to worry about defining a few small functions on where to find/put data files and determine which files to include in the day files.  It must also define the <span class="softwareName">main</span> function and anything needed to parse the command line arguments.</p>

    <p><a href="#top">Top</a></p>

    <hr />
    <p class="foot">Last Updated: August 14, 2007 - jclawson</p>
  </body>
</html>
