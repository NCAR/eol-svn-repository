c
c $Id: rdcls.f,v 1.1 1992/11/02 21:08:32 john Exp $
c
	PROGRAM RDCLS
c test program
c tests the reading of class files (STORM CLASS Format or SCF)

	REAL CLDATA(21),RDATA(1),LATLON(2)
	CHARACTER*130 HDRSTR
	CHARACTER*10 CDATA
	CHARACTER*100 CTMP
	INTEGER J,IDATA(620),SCFUNI
	INTEGER ITMP,JTMP
	REAL RTMP

	SCFUNI = 11

	OPEN (FILE='j21506.s',UNIT=SCFUNI,STATUS='OLD')

	RTMP = 1737.73
	WRITE (*,'(F4.0)') RTMP

C Read SCF header lines
C  Skip 1st 2 lines, then get Site ID from 3rd line
	READ (SCFUNI,'(A130)') HDRSTR
	READ (SCFUNI,'(A130)') HDRSTR
	READ (SCFUNI,'(A130)') HDRSTR
C	CDATA(1:10) = HDRSTR(36:45)
	DO 15, J = 130,1,-1
	  IF (HDRSTR(J:J) .NE. ' ') THEN
	    GO TO 16
	  END IF
15	CONTINUE
16	CONTINUE
	CDATA(1:3) = HDRSTR(J-2:J)
C23456789012345678901234567890123456789012345678901234567890123456789012
C	READ (SCFUNI,'(A59,2X,F7.2,2X,F6.2,2X,F6.2)'),HDRSTR,LATLON(2),
C &	  LATLON(1),RDATA(1)
C	READ (SCFUNI,'(A35,I4,2X,I2,2X,I2,2X,I2,X,I2,X,I2)')
C &	  HDRSTR,IDATA(1),IDATA(2),IDATA(3),IDATA(4),IDATA(5),IDATA(6)

C skip the ddd mm.mm'W latlon stuff --- it's harder to read, and it's
C  not any better (it was derived from the decimal values)
C	READ (SCFUNI,'(A59,F,F,F)') HDRSTR,LATLON(2),LATLON(1),RDATA(1)
C	READ (SCFUNI,'(A35,3I,X,I2,X,I2,X,I2)') HDRSTR,IDATA

	READ (SCFUNI,'(A59,2F,A)') HDRSTR,LATLON(2),LATLON(1),CTMP
	IF (INDEX(CTMP,'.') .EQ. 0) THEN
	  READ (CTMP,'(I)') ITMP
	  RDATA(1) = REAL(ITMP)
	ELSE
	  READ (CTMP,'(F)') RDATA(1)
	END IF
	READ (SCFUNI,'(A35,3I,3(X,I2))') HDRSTR,
&	  IDATA(1),IDATA(2),IDATA(3),IDATA(4),IDATA(5),IDATA(6)

C  Rest of header lines ignored
	DO 20, J = 6,15
	  READ(SCFUNI,'(A130)') HDRSTR
20	CONTINUE


	WRITE (*,*) 'NOW READING DATA'
	READ (SCFUNI,*) CLDATA

	WRITE (*,100) CLDATA

C0       1         2         3         4         5         6         7 7
C23456789012345678901234567890123456789012345678901234567890123456789012

100	FORMAT ( F6.1, 1X, F6.1, 1X, F5.1, 1X, F5.1, 1X, F5.1, 1X,
&	F6.1, 1X, F6.1, 1X, F5.1, 1X, F5.1, 1x, F5.1, 1X,
&	F8.3, 1X, F7.3, 1X, F5.1, 1X, F5.1, 1X, F7.1, 1X, 
&	F4.1, 1X, F4.1, 1X, F4.1, 1X, F4.1, 1X, F4.1, 1X, F4.1 )

	STOP

	END
