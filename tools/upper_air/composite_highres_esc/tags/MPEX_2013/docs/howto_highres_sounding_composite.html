<html>
<head>
<title>How To: Create the High Resolution Sounding Composite</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="http://dmg.eol.ucar.edu/css/howto.css">
</head>

<body>
<h1>How To: Create the High Resolution Sounding Composite</h1>
<h2>Table of Contents</h2>
<ol>
	<li><a href="#purpose">Purpose</a></li>
	<li>Previous Versions<ol>
                <li><a href="#version_mpex">mpex_2013</a></li>
                <li><a href="#version_dc3">DC3 2012</a></li>
                <li><a href="#version_itop">ITOP 2010</a></li>
                <li><a href="#version_vocals">VOCALS 2008</a></li>
                <li><a href="#version_vortex2">VORTEX2 2009/2010</a></li>
                <li><a href="#version_rainex">RAINEX 2005</a></li>
                <li><a href="#version_cupido">CuPIDO 2006</a></li>
                <li><a href="#version_trex">T-REX 2006</a></li>
		<li><a href="#version_rico">RICO_2004-2005</a></li>
		</ol></li>
	<li><a href="#directory">Directory Structure</a></li>
	<li>Processing the Data<ol>
	        <li><a href="#copy">Copy the CLASS Files</a></li>
		<li><a href="#day">Creating the Day Files</a></li>
                <li><a href="#documentation">Creating the Composite Document</a></li>
		<li><a href="#codiac">Inserting into the Database</a></li>
		</ol></li>
	<li><a href="#software">Software</a></li>
	<li><a href="#documents">Documentation</a></li>
</ol>
<hr>

<a name="purpose"></a>
<h3>Purpose</h3>
<p>This document contains the instructions on how to generate the High Resolution Sounding Composite.</p>
<hr>

<h3>Previous Versions</h3>

<a name="version_mpex"></a>
<h4>MPEX (2013)</h4>
<table>
        <tr><th>Software:</th><td><a href="http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_">http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_</a></td></tr>
        <tr><th>Raw Data:</th><td>Includes all final processed soundings from individual networks.</td></tr>
        <tr><th>Final Data:</th><td>/net/archive/data/</td></tr>
        <tr><th>Notes:</th><td> Same simple method. Copied converted files into data area and then ran "ant dayfiles" command ensuring that build.xml was updated for MPEX 2013 processing. See the MPEX specific build.xml in that tag of SVN. Note that when checking the final sort order in the composite day files, the final sort should be by Nominal Time then by latitude.  Also ensure that the files used to form the dayfiles (placed in /converted_data) are the individual sounding files and not day files from the individual networks. 
</td></tr>
</table>


<a name="version_dc3"></a>
<h4>DC3 (2012)</h4>
<table>
        <tr><th>Software:</th><td><a href="http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_">http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_</a></td></tr>
        <tr><th>Raw Data:</th><td>Includes all final processed soundings from individual networks.</td></tr>
        <tr><th>Final Data:</th><td>/net/archive/data/</td></tr>
        <tr><th>Notes:</th><td> Same simple method. Copied converted files into data area and then ran "ant dayfiles" command ensuring that build.xml was updated for DC3 2012 processing. See the DC3 specific build.xml in that tag of SVN.
</td></tr>
</table>


<a name="version_itop"></a>
<h4>ITOP (2010)</h4>
<table>
        <tr><th>Software:</th><td><a href="http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_">http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_</a></td></tr>
        <tr><th>Raw Data:</th><td>Includes all final processed soundings from individual networks.</td></tr>
        <tr><th>Final Data:</th><td>/net/archive/data/</td></tr>
        <tr><th>Notes:</th><td> Same as VOCALS method. Simply copied converted files into data area and then ran "ant dayfiles" command ensuring that build.xml was updated for ITOP 2010 processing.
</td></tr>
</table>


<a name="version_vocals"></a>
<h4>VOCALS (2008)</h4>
<table>
        <tr><th>Software:</th><td><a href="http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_">http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_</a></td></tr>
        <tr><th>Raw Data:</th><td>Includes all final processed soundings from individual networks.</td></tr>
        <tr><th>Final Data:</th><td>/net/archive/data/</td></tr>
        <tr><th>Notes:</th><td>For VOCALS 2008, we created both the High Resolution and 5mb composites.
It is possible to use the steps below, but for VOCALS, LEC followed slightly different method, but with same results. LEC did the following:
Hand copied network dayfiles from the individual ESC formatted datasets into the /converted_data directory;
Updated build.xml file to create dayfiles from data in /converted_data dir and place composite
dayfiles in /database dir. Run "ant dayfiles". Then updated description doc in /docs dir. This is basically
the same as shown below, but more was done manually. See also <a href="http://www.eol.ucar.edu/about/our-organization/cds/dmg/dmg-internal/dmg-documentation/how-to/how-to-create-the-high-resolution-sounding-composite?searchterm=Create+sounding+composite" > DMG How To</a>. <i> Beware to use the build.xml file and the latest version of the dayfiles tool. As of Jan 2011 the dayfiles tool is written in Java.</i> </td></tr>
</table>


<a name="version_vortex2"></a>
<h4>VORTEX2 (2009/2010)</h4>
<table>
        <tr><th>Software:</th><td><a href="http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_">http://svn.eol.ucar.edu/websvn/listing.php?repname=dmg&path=%2Ftools%2Fupper_air%2Fcomposite_highres_esc%2F#_tools_upper_air_composite_highres_esc_</a></td></tr>
        <tr><th>Raw Data:</th><td>Includes all final processed soundings from individual networks.</td></tr>
        <tr><th>Final Data:</th><td>/net/archive/data/</td></tr>
        <tr><th>Notes:</th><td>For VORTEX2, only required to create High Resolution Composites. It is possible to use the steps below, but for VORTEX2, LEC followed slightly different method, but with same results. LEC did the following: 
Hand copied dayfiles from the individual ESC formatted datasets into /converted_data directory; 
Updated build.xml file to create dayfiles from data in /converted_data dir and place composite
dayfiles in /database dir. Run "ant dayfiles". Then updated description doc in /docs dir. This is basically
the same as shown below, but more was done manually.</td></tr>
</table>

<a name="version_rainex"></a>
<h4>RAINEX (2005)</h4>
<table>
        <tr><th>Software:</th><td><a href="http://svn.eol.ucar.edu/svn/dmg/tools/upper_air/composite_highres_esc/tags/RAINEX_2005">http://svn.eol.ucar.edu/svn/dmg/tools/upper_air/composite_highres_esc/tags/RAINEX_2005</a></td></tr>
        <tr><th>Raw Data:</th><td>Comes from the final processed soundings.</td></tr>
        <tr><th>Final Data:</th><td>/net/archive/data/</td></tr>
</table>

<a name="version_cupido"></a>
<h4>CuPIDO (2006)</h4>
<table>
	<tr><th>Software:</th><td>/net/work/CUPIDO/upper_air/composite_highres</td></tr>
	<tr><th>Raw Data:</th><td>Comes from the final processed soundings</td></tr>
	<tr><th>Final Data:</th><td>/net/archive/data/cupido/upper_air/composite</td></tr>
</table>

<a name="version_trex"></a>
<h4>T-REX (2006)</h4>
<table>
	<tr><th>Software:</th><td>/work/TREX/upper_air/composite_highres/software</td></tr>
	<tr><th>Raw Data:</th><td>Comes from the final processed soundings</td></tr>
	<tr><th>Final Data:</th><td>/archive/data/trex/upper_air/soundings/composite/highres</td></tr>
</table>

<a name="version_rico"></a>
<h4>RICO (2004-2005)</h4>
<table>
	<tr><th>Software:</th><td>/work/RICO/upperair/composite/highres/software</td></tr>
	<tr><th>Raw Data:</th><td>Comes from the final processed soundings</td></tr>
	<tr><th>Final Data:</th><td>/archive/codiac/rico/upper_air/composite/highres</td></tr>
</table>
<hr>

<a name="directory"></a>
<h3>Directory Structure</h3>
<table>
	<tr><th>composite_highres/</th><td>The main directory for the processing.</td></tr>
        <tr><th>build.xml</th><td>Configuration file containing commands to create the composite.</td></tr>
	<tr><td>database</td><td>The directory where the final day files are placed once they habe been created.</td></tr>
	<tr><td>data</td><td>The directory where the files are copied to so the software can find it.</td></tr>
	<tr><td>docs</td><td>The directory containing documentation about the processing and the data.</td></tr>
</table>
<hr>

<h3>Processing the Data</h3>

<a name="copy"></a>
<h4>Updating the Project Specific Information</h4>
<p>The first step of creating the composite, is to update the <b>build.xml</b> file with the current project's information.  You will need to change the following properties:</p>
<ul>
    <li><b>project</b></li>
    <li><b>project.dir</b></li>
</ul>
<p>These properties are used by the build to properly name and store the day files once they are created.</p>

<h4>Copying the CLASS Files</h4>
<p>Before the day files can be created, the ESC files from the individual network conversions to be included in the composite needed to be copied into the <b>data</b> directory. You can do this by "hand" for each network, or this is done by using the <b>copy</b> ant command.  Beware when using the copy command that you are copying the proper files.  This <b>build.xml</b> file needs to be edited to change the names and locations of the ESC files for each network.</p>
<p class="code">ant copy</p>

<a name="day"></a>
<h4>Creating the Day Files</h4>
<p>Once the data has been copied to the <b>data</b> directory, they need to be combined to form day files.  This is done using the command:</p>
<p class="code">ant dayfiles</p>
<p>This can be a very slow process as it must read in all of the sounding headers, sort them by their nominal dates, then reload each sounding by day and generate the day file.  They will be placed in the <code>dayfile.dir</code> directory defined in the <b>build.xml</b></a> file.</p>

<a name="documentation"></a>
<h4>Creating the Composite Document</h4>
<p>NOTE: This step is now done by Scot Loehrer. He creates the final PDF file that we load with the data. <br><br>Old method::  You will need to update/write the README document that will be put online with the data. Sometimes the amount of changes to the document is relatively small since all of the networks contained in the composite will also have their documents attached to the composite data set containing the specifics.  The document changes include:</p>
<ul>
    <li>Changing the Project ID in the document title and header.</li>
    <li>Changing the list of included networks and links to the specific document in the <i>General Description</i>.</li>
    <li>Updating the project specific information at the end of the <i>General Description</i>.</li>
    <li>Changing the project ID in the <i>Sample Data</i> section.</li>
    <li>Replace the sample data with data from the current project.</li>
    <li>Update the <i>Station List</i> to include all of the stations included in the composite data set.</li>
</ul>

<a name="codiac"></a>
<h4>Inserting into the Database</h4>
<p>With all of the day files created, they need to be inserted into the database. You will also need to update the DMG Data Tracking System information and Processing Inventory Tool (IVEN) info on forming this composite.</p>
<hr>

<a name="software"></a>
<h3>Software</h3>
<p>The following is a list of ant targets defined in the <b>build.xml</b> file.</p>
<ul>
   <li><b>copy</b>: This copies all of the best data for each network in the composite into a local data directory.</li>
   <li><b>dayfiles</b>: This generates properly sorted day files for the data contained in the local data directory.</li>
</ul>
<hr>

<a name="documents"></a>
<h3>Documentation</h3>
<p>The following are a list of documents that may help with the conversion or are related to the raw data.</p>
<ul>
    <li><a href="#">How To: Create a High Resolution Sounding Composite</a>- This document.</li>
    <li><a href="http://www.eol.ucar.edu/about/our-organization/cds/dmg/dmg-internal/dmg-documentation/how-to/ant-setup-and-use">How To: Set Up and Use Ant</a>- Guide to using and setting up the Ant environment needed to run the composite software.</li>
    <li><a href="http://www.eol.ucar.edu/about/our-organization/cds/dmg/dmg-internal/dmg-documentation/how-to/how-to-use-subversion">How To: Use Subversion</a>- Guide to using subversion.</a>
    <li><a href="readme_rainex_highres_sounding.html">README_RAINEX_HighRes_sounding.html</a>- The database readme for the RAINEX project.</li>
    <li><a href="http://www.eol.ucar.edu/about/our-organization/cds/dmg/dmg-internal/dmg-documentation/tutorial/sounding-processing-and-composite-generation">Sounding Processing and Composite Generation Tutorial</a>- Guide to the processing of soundings and the formation of composites.</li>
</ul>
<hr>

<p class="foot">Last Updated: 18 April 2012 - L. E. Cully</p>
</body>
</html>
