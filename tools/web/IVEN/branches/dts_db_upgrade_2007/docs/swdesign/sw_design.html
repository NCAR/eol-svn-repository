<html>
<head>
	<title>IVEN: Software Design</title>
</head>

<body>

<h1><center>IVEN: Software Overview and Design</h1></center>

<p>
<font size=+1><b>Design Scheme</b></font><br>
The software for the Iven application was designed to separate the html view, the access 
to the database, and the control or application state.  The view consists of several perl 
scripts (referred to as <i>view scripts</i>), which provide the html code to the browser.  The access to the MySQL database 
is performed by a series of database access (DBA) modules.  The state of the application is 
maintained with a single State (in the State.pm module) class.  
</p>

<p>
<font size=+1><b>Database Access</b></font><br>
For each table in the database a simple container class and a DBA module were written.  
The container class holds a single record for the table with public instance variables.  The 
DBA module performs all database queries passing instances of the container class to and from the 
view portion of the application.<br>
	<dd><table border=0 cellpadding=2 cellspacing=2>
		<tr>
			<th>Container Classes</th>
			<th>DBA modules</th>
		</tr>

		<tr>
			<td><a href=../cgi/lib/Dataset.pm>Dataset.pm</a></td>
			<td><a href=../cgi/lib/DatasetDBA.pm>DatasetDBA.pm</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/lib/Product.pm>Product.pm</a></td>
			<td><a href=../cgi/lib/ProductDBA.pm>ProductDBA.pm</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/lib/Project.pm>Project.pm</a></td>
			<td><a href=../cgi/lib/ProjectDBA.pm>ProjectDBA.pm</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/lib/Extraction.pm>Extraction.pm</a></td>
			<td><a href=../cgi/lib/ExtractionDBA.pm>ExtractionDBA.pm</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/lib/User.pm>User.pm</a></td>
			<td><a href=../cgi/lib/UserDBA.pm>UserDBA.pm</a></td>
		</tr>
	</table>
<br>
	<b>Also see the <a href=../doc>documentation</a> generated by perldoc.</b>
</p>
	</table>
<br>
</p>

<p>
<font size=+1><b>View</b></font><br>
Each view (project_view, dataset_view, etc.) obtains the needed data from the database by 
making calls to the database access (DBA) modules.  The data is received in the container classes 
and the needed html code is sent to the browser.  
	<dd><b>View Scripts: </b>
	<dd><a href=../cgi/project_view>project_view</a>
	<dd><a href=../cgi/product_view>product_view</a>
	<dd><a href=../cgi/dataset_view>dataset_view</a>
	<dd><a href=../cgi/user_view>user_view</a>
	<dd><a href=../cgi/thread_view>thread_view</a>
	<dd><a href=../cgi/project_list>project_list</a>
</p>

<p>
<font size=+1><b>State</b></font> (<a href=../cgi/lib/State.pm>State.pm</a>)<br>
The HTTP protocol is a <i>stateless</i> protocol and a pitfall of CGI is the 
inability to maintain session information between the server and the browser.  
It is therefore necessary to maintain the state using parameters in 
the URLs and hidden input fields when using html forms for data input.  The State class 
simplifies this by supplying a simple API to the view scripts to obtain the needed URL or hidden 
fields that describe the current state.  The State class maintains information such as
which view the user is in, the project, the product (if in product view), etc.  When
a link is needed from one view to another (an html link that is), the getUrlString() or
getUrlStringJS() subroutine is called to obtain the needed URL.  These subroutines do the 
needed encoding of the URL, include all state information within the URL, and determine
which view script is being requested.  Similarly, when an html form is needed the getHiddenFieldString()
subroutine is called to obtain the needed &lt;input type=hidden ...&gt;   tags to maintain the state.
</p>
<p><b>NOTE: </b>Originally a <a href=../cgi/controller>controller</a> script was written which determined
the view script from the state.  This was more straight forward but slowed things down quite a bit.  
The getUrlString(), getUrlStringJS(), and getHiddenFieldString() within State.pm now determine the 
view script. 
</p>

<p>
<font size=+1><b>Edit</b></font><br>
The editing portion of the application is a special case of the view.  To edit a portion of 
the database, the system uses a script to output the html form and a corresponding script to process the 
user input.
<dd>
	<table border=0 cellpadding=2 cellspacing=2>
		<tr>
			<th>Display edit form</th>
			<th>Process input</th>
		</tr>
		<tr>
			<td><a href=../cgi/edit_proj_notes>edit_proj_notes</a></td>
			<td><a href=../cgi/proc_proj_notes>proc_proj_notes</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/edit_product>edit_product</a></td>
			<td><a href=../cgi/proc_product>proc_product</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/edit_ds_admin>edit_ds_admin</a></td>
			<td><a href=../cgi/proc_ds_admin>proc_ds_admin</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/edit_ds_status>edit_ds_status</a></td>
			<td><a href=../cgi/proc_ds_status>proc_ds_status</a></td>
		</tr>
		<tr>
			<td><a href=../cgi/edit_extraction>edit_extraction</a></td>
			<td><a href=../cgi/proc_extraction>proc_extraction</a></td>
		</tr>
	</table>	
</p>

</body>
</html>
