
use strict;

sub product_view
{
	my $state = shift;
	my $cgi = shift;

	println( $cgi->header() );
	println( "<html>" );
		println( "<head>" );
		println( "<title>Iven Product view</title>" );
		println( $css );
		println( $jscript );
	println( "</head>" );
	println( "<body>" );
	menu( $state, $cgi );

	my $pd = ProductDBA::buildProductView( $state->{project}, $state->{product} );

	println( "<br>" );

	println( "<table border=0 cellpadding=4 cellpadding=1 width=98% class=productTable>" );
		println( "<tr class=productTitle>" );
				println( "<td colspan=4>$pd->{pdname}</td>" );
		println( "</tr>" );
		println( "<tr class=productHead>" );
			println( "<td width=25%>Dataset</td>" );
			println( "<td width=10%>Converting</td>" );
			println( "<td width=8%>Status</td>" );
			println( "<td width=57%>Notes</td>" );
		println( "</tr>" );
		foreach my $ds (@{$pd->{datasets}})
		{
			my $trclass = "dsRow";
			$trclass = "exRow" if( $ds->{is_extraction} );

			my $url = $state->getUrlString( "view" => $DATASET, "dataset" => $ds->{dsname}, "product" => $pd->{pdname} );
			#println( "<tr class=$trclass onmouseover=\"cursorOver(this)\" onmouseout=\"cursorOut(this)\">" );	
			println( "<tr class=$trclass>" );
				println( "<td width=25%><a href=$url>$ds->{dsname}</a></td>" );
				println( "<td width=10%>$ds->{user_processing_object}->{fname}</td>" );
				println( "<td width=8%>" );
					println( getStatus( $ds->{status} ) );
				println( "</td>" );
				println( "<td width=57%><div style=\"position:relative;height:100px;overflow:auto;\"> $ds->{admin_notes}</div></td>" );
			println( "</tr>" );	
		}
	println( "</table>" );
	println( "</body></html>" );
}

sub getStatus
{
	my $st = shift;
	my $ret;

	if( $st eq "done" )
	{
		$ret = "<font color=blue>DONE</font>";
	}
	elsif( $st eq "tbd" )
	{
		$ret = "<font color=red>TBD</font>";
	}
	elsif( $st eq "in_progress" )
	{
		$ret = "<font color=gray>N/A</font>";
	}

	return $ret;
}
1;
