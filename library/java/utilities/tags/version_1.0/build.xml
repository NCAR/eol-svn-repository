<project name="Utilities" default="compile" basedir=".">

    <property name="build" location="build" />
    <property name="build.classes" location="build/classes" />
    <property name="build.tests" location="build/tests" />
    <property name="deploy.doc" location="/net/web/dmg/html/software/library/java/utilities" />
    <property name="deploy.jar" location="/net/work/lib/java" />
    <property name="dist" location="dist" />
    <property name="docs" location="docs" />
    <property name="docs.api" location="${docs}/api" />
    <property name="jarfile" value="utilities.jar" />
    <property name="reports" location="reports" />
    <property name="resources" location="resources" />
    <property name="src" location="src" />
    <property name="tests" location="tests" />

    <path id="classpath">
        <pathelement path="${classpath}" />
    </path>

    <path id="test-classpath">
        <fileset dir="/net/work/lib/java/vendor">
            <include name="junit.jar" />
        </fileset>
        <pathelement path="${build.classes}" />
        <pathelement path="${build.tests}" />
        <path refid="classpath" />
    </path>

    <target name="clean">
        <delete dir="${build}" />
        <delete dir="${dist}" />
        <delete dir="${docs.api}" />
    </target>

    <target name="compile" depends="init">
        <copy todir="${build.classes}">
            <fileset dir="${resources}" />
        </copy>
        <javac srcdir="${src}" destdir="${build.classes}">
            <classpath refid="classpath" />
        </javac>
    </target>

    <target name="compileTests" depends="compile">
        <mkdir dir="${build.tests}" />
        <javac srcdir="${tests}" destdir="${build.tests}">
            <classpath refid="test-classpath" />
        </javac>
    </target>

    <target name="deploy" depends="dist, javadoc">
        <delete dir="${deploy.doc}" />
        <mkdir dir="${deploy.doc}" />
        <copy file="${dist}/${jarfile}" todir="${deploy.jar}" />
        <copy todir="${deploy.doc}">
           <fileset dir="${docs.api}" />
        </copy>
    </target>

    <target name="dist" depends="compile">
        <mkdir dir="${dist}" />
        <jar destfile="${dist}/${jarfile}" basedir="${build.classes}" />
    </target>

    <target name="init">
        <tstamp />
        <mkdir dir="${build.classes}" />
    </target>

    <target name="javadoc">
        <mkdir dir="${docs.api}" />
        <javadoc destdir="${docs.api}" author="true" version="true" use="true" 
                 windowtitle="DMG Utilities API" doctitle="Data Managment Group General Utilities API"
                 stylesheetfile="/net/web/dmg/html/css/javadocs.css"
                 header="DMG Util API" overview="${docs}/overview.html">
            <classpath refid="classpath" />
            <fileset dir="${src}" defaultexcludes="yes" />
            <link href="http://java.sun.com/j2se/1.5.0/docs/api" />
        </javadoc>
    </target>

    <target name="test" depends="compileTests">
        <java classname="dmg.UtilTests" fork="yes">
            <classpath refid="test-classpath" />
        </java>
    </target>

</project>
